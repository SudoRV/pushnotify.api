{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\Desktop\\\\projects\\\\jWTFcm\\\\clients\\\\pushnotify.api\\\\src\\\\components\\\\RegisterDevice.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { requestNotificationPermission, getDeviceToken } from \"../functions/getDeviceToken\";\nimport notification_on from \"../icons/notification_on.svg\";\nimport notification_off from \"../icons/notification_off.svg\";\nimport \"../styles/RegisterDevice.scss\"; // Import styles\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RegisterDevice = ({\n  onToken\n}) => {\n  _s();\n  const [deviceToken, setDeviceToken] = useState(\"\");\n  const [notificationStatus, setNotificationStatus] = useState(Notification.permission);\n  const preRef = useRef(null);\n  const textRef = useRef(null);\n  const iconRef = useRef(null);\n\n  // Fetch saved token on mount\n  useEffect(() => {\n    const savedData = localStorage.getItem(\"t_data\");\n    if (savedData) {\n      const {\n        \"web-device-token\": storedToken\n      } = JSON.parse(savedData);\n      if (storedToken) setDeviceToken(storedToken);\n    }\n  }, []);\n  const handleRegisterDevice = async () => {\n    await handleRequestPermission();\n    if (deviceToken) {\n      navigator.clipboard.writeText(deviceToken);\n      if (onToken) onToken(deviceToken);\n      return;\n    }\n    const token = await getDeviceToken();\n    if (token) {\n      setDeviceToken(token);\n      const updatedData = {\n        ...JSON.parse(localStorage.getItem(\"t_data\") || \"{}\"),\n        \"web-device-token\": token\n      };\n      localStorage.setItem(\"t_data\", JSON.stringify(updatedData));\n    }\n  };\n  const handleRequestPermission = async () => {\n    const isGranted = await requestNotificationPermission();\n    setNotificationStatus(isGranted ? \"granted\" : \"denied\");\n\n    // Show permission status temporarily\n    if (preRef.current && iconRef.current) {\n      preRef.current.classList.add(\"show-notification-status\");\n      iconRef.current.classList.add(\"shake\");\n      textRef.current.innerText = isGranted ? \"Allowed\" : \"Blocked\";\n      setTimeout(() => {\n        preRef.current.classList.remove(\"show-notification-status\");\n        iconRef.current.classList.remove(\"shake\");\n      }, 4000);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"register-device flex fdc api-step\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex jcsb aic\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"2\\uFE0F\\u20E3 Get Device Token\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: preRef,\n        className: \"notification_cont flex jcfe aic\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          ref: textRef,\n          children: notificationStatus === \"granted\" ? \"Allowed\" : \"Blocked\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          ref: iconRef,\n          className: \"notification_icon\",\n          src: notificationStatus === \"granted\" ? notification_on : notification_off,\n          alt: \"Notification Status\",\n          onClick: handleRequestPermission,\n          style: {\n            cursor: \"pointer\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w100 flex fdc\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        className: \"api-input\",\n        placeholder: \"Device Token\",\n        value: deviceToken,\n        readOnly: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleRegisterDevice,\n        className: \"api-btn\",\n        children: deviceToken ? \"Copy Token\" : \"Register Device\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n};\n_s(RegisterDevice, \"H7yXS+RG4P7bQ2hdAdkYIpEsVgk=\");\n_c = RegisterDevice;\nexport default RegisterDevice;\nvar _c;\n$RefreshReg$(_c, \"RegisterDevice\");","map":{"version":3,"names":["React","useState","useEffect","useRef","requestNotificationPermission","getDeviceToken","notification_on","notification_off","jsxDEV","_jsxDEV","RegisterDevice","onToken","_s","deviceToken","setDeviceToken","notificationStatus","setNotificationStatus","Notification","permission","preRef","textRef","iconRef","savedData","localStorage","getItem","storedToken","JSON","parse","handleRegisterDevice","handleRequestPermission","navigator","clipboard","writeText","token","updatedData","setItem","stringify","isGranted","current","classList","add","innerText","setTimeout","remove","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","src","alt","onClick","style","cursor","type","placeholder","value","readOnly","_c","$RefreshReg$"],"sources":["C:/Users/PC/Desktop/projects/jWTFcm/clients/pushnotify.api/src/components/RegisterDevice.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { requestNotificationPermission, getDeviceToken } from \"../functions/getDeviceToken\";\n\nimport notification_on from \"../icons/notification_on.svg\";\nimport notification_off from \"../icons/notification_off.svg\";\nimport \"../styles/RegisterDevice.scss\"; // Import styles\n\nconst RegisterDevice = ({ onToken }) => {\n  const [deviceToken, setDeviceToken] = useState(\"\");\n  const [notificationStatus, setNotificationStatus] = useState(Notification.permission);  \n\n  const preRef = useRef(null);\n  const textRef = useRef(null);\n  const iconRef = useRef(null);\n\n  // Fetch saved token on mount\n  useEffect(() => {\n    const savedData = localStorage.getItem(\"t_data\");\n    if (savedData) {\n      const { \"web-device-token\": storedToken } = JSON.parse(savedData);\n      if (storedToken) setDeviceToken(storedToken);\n    }\n  }, []);\n\n  const handleRegisterDevice = async () => {\n    await handleRequestPermission();\n    \n    if (deviceToken) {\n      navigator.clipboard.writeText(deviceToken);\n      if (onToken) onToken(deviceToken);\n      return;\n    }\n\n    const token = await getDeviceToken();\n    if (token) {\n      setDeviceToken(token);\n      const updatedData = { ...JSON.parse(localStorage.getItem(\"t_data\") || \"{}\"), \"web-device-token\": token };\n      localStorage.setItem(\"t_data\", JSON.stringify(updatedData));\n    }\n  };\n\n  const handleRequestPermission = async () => {\n    const isGranted = await requestNotificationPermission();\n    setNotificationStatus(isGranted ? \"granted\" : \"denied\");\n\n    // Show permission status temporarily\n    if (preRef.current && iconRef.current) {\n      preRef.current.classList.add(\"show-notification-status\");\n      iconRef.current.classList.add(\"shake\");\n\n      textRef.current.innerText = isGranted ? \"Allowed\" : \"Blocked\";\n\n      setTimeout(() => {\n        preRef.current.classList.remove(\"show-notification-status\");\n        iconRef.current.classList.remove(\"shake\");\n      }, 4000);\n    }\n  };\n\n  return (\n    <div className=\"register-device flex fdc api-step\">\n      <div className=\"flex jcsb aic\">\n        <h3>2️⃣ Get Device Token</h3>\n        <div ref={preRef} className=\"notification_cont flex jcfe aic\">\n          <p ref={textRef}>{notificationStatus === \"granted\" ? \"Allowed\" : \"Blocked\"}</p>\n          <img \n            ref={iconRef} \n            className=\"notification_icon\"\n            src={notificationStatus === \"granted\" ? notification_on : notification_off} \n            alt=\"Notification Status\"\n            onClick={handleRequestPermission}\n            style={{ cursor: \"pointer\" }} \n          />\n        </div>\n      </div>\n\n      <div className=\"w100 flex fdc\">\n        <input type=\"text\" className=\"api-input\" placeholder=\"Device Token\" value={deviceToken} readOnly />\n        <button onClick={handleRegisterDevice} className=\"api-btn\">\n          {deviceToken ? \"Copy Token\" : \"Register Device\"}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default RegisterDevice;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,SAASC,6BAA6B,EAAEC,cAAc,QAAQ,6BAA6B;AAE3F,OAAOC,eAAe,MAAM,8BAA8B;AAC1D,OAAOC,gBAAgB,MAAM,+BAA+B;AAC5D,OAAO,+BAA+B,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,cAAc,GAAGA,CAAC;EAAEC;AAAQ,CAAC,KAAK;EAAAC,EAAA;EACtC,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACc,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGf,QAAQ,CAACgB,YAAY,CAACC,UAAU,CAAC;EAErF,MAAMC,MAAM,GAAGhB,MAAM,CAAC,IAAI,CAAC;EAC3B,MAAMiB,OAAO,GAAGjB,MAAM,CAAC,IAAI,CAAC;EAC5B,MAAMkB,OAAO,GAAGlB,MAAM,CAAC,IAAI,CAAC;;EAE5B;EACAD,SAAS,CAAC,MAAM;IACd,MAAMoB,SAAS,GAAGC,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;IAChD,IAAIF,SAAS,EAAE;MACb,MAAM;QAAE,kBAAkB,EAAEG;MAAY,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACL,SAAS,CAAC;MACjE,IAAIG,WAAW,EAAEX,cAAc,CAACW,WAAW,CAAC;IAC9C;EACF,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMG,oBAAoB,GAAG,MAAAA,CAAA,KAAY;IACvC,MAAMC,uBAAuB,CAAC,CAAC;IAE/B,IAAIhB,WAAW,EAAE;MACfiB,SAAS,CAACC,SAAS,CAACC,SAAS,CAACnB,WAAW,CAAC;MAC1C,IAAIF,OAAO,EAAEA,OAAO,CAACE,WAAW,CAAC;MACjC;IACF;IAEA,MAAMoB,KAAK,GAAG,MAAM5B,cAAc,CAAC,CAAC;IACpC,IAAI4B,KAAK,EAAE;MACTnB,cAAc,CAACmB,KAAK,CAAC;MACrB,MAAMC,WAAW,GAAG;QAAE,GAAGR,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC;QAAE,kBAAkB,EAAES;MAAM,CAAC;MACxGV,YAAY,CAACY,OAAO,CAAC,QAAQ,EAAET,IAAI,CAACU,SAAS,CAACF,WAAW,CAAC,CAAC;IAC7D;EACF,CAAC;EAED,MAAML,uBAAuB,GAAG,MAAAA,CAAA,KAAY;IAC1C,MAAMQ,SAAS,GAAG,MAAMjC,6BAA6B,CAAC,CAAC;IACvDY,qBAAqB,CAACqB,SAAS,GAAG,SAAS,GAAG,QAAQ,CAAC;;IAEvD;IACA,IAAIlB,MAAM,CAACmB,OAAO,IAAIjB,OAAO,CAACiB,OAAO,EAAE;MACrCnB,MAAM,CAACmB,OAAO,CAACC,SAAS,CAACC,GAAG,CAAC,0BAA0B,CAAC;MACxDnB,OAAO,CAACiB,OAAO,CAACC,SAAS,CAACC,GAAG,CAAC,OAAO,CAAC;MAEtCpB,OAAO,CAACkB,OAAO,CAACG,SAAS,GAAGJ,SAAS,GAAG,SAAS,GAAG,SAAS;MAE7DK,UAAU,CAAC,MAAM;QACfvB,MAAM,CAACmB,OAAO,CAACC,SAAS,CAACI,MAAM,CAAC,0BAA0B,CAAC;QAC3DtB,OAAO,CAACiB,OAAO,CAACC,SAAS,CAACI,MAAM,CAAC,OAAO,CAAC;MAC3C,CAAC,EAAE,IAAI,CAAC;IACV;EACF,CAAC;EAED,oBACElC,OAAA;IAAKmC,SAAS,EAAC,mCAAmC;IAAAC,QAAA,gBAChDpC,OAAA;MAAKmC,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAC5BpC,OAAA;QAAAoC,QAAA,EAAI;MAAoB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC7BxC,OAAA;QAAKyC,GAAG,EAAE/B,MAAO;QAACyB,SAAS,EAAC,iCAAiC;QAAAC,QAAA,gBAC3DpC,OAAA;UAAGyC,GAAG,EAAE9B,OAAQ;UAAAyB,QAAA,EAAE9B,kBAAkB,KAAK,SAAS,GAAG,SAAS,GAAG;QAAS;UAAA+B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC/ExC,OAAA;UACEyC,GAAG,EAAE7B,OAAQ;UACbuB,SAAS,EAAC,mBAAmB;UAC7BO,GAAG,EAAEpC,kBAAkB,KAAK,SAAS,GAAGT,eAAe,GAAGC,gBAAiB;UAC3E6C,GAAG,EAAC,qBAAqB;UACzBC,OAAO,EAAExB,uBAAwB;UACjCyB,KAAK,EAAE;YAAEC,MAAM,EAAE;UAAU;QAAE;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9B,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC,eAENxC,OAAA;MAAKmC,SAAS,EAAC,eAAe;MAAAC,QAAA,gBAC5BpC,OAAA;QAAO+C,IAAI,EAAC,MAAM;QAACZ,SAAS,EAAC,WAAW;QAACa,WAAW,EAAC,cAAc;QAACC,KAAK,EAAE7C,WAAY;QAAC8C,QAAQ;MAAA;QAAAb,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACnGxC,OAAA;QAAQ4C,OAAO,EAAEzB,oBAAqB;QAACgB,SAAS,EAAC,SAAS;QAAAC,QAAA,EACvDhC,WAAW,GAAG,YAAY,GAAG;MAAiB;QAAAiC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzC,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACN,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAACrC,EAAA,CA7EIF,cAAc;AAAAkD,EAAA,GAAdlD,cAAc;AA+EpB,eAAeA,cAAc;AAAC,IAAAkD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}